# Duragon Implementation Progress Log
#
# Instructions for implementors:
# - APPEND new entries to this file (never overwrite existing content)
# - Format: [YYYY-MM-DD HH:MM] task-id: description of what was done
# - When marking a task as passes: true in PRD.json, log it here
# - Include any blockers, decisions, or notes
#
# Example entries:
# [2025-01-15 14:30] setup-001: Initialized pnpm monorepo, created workspace config
# [2025-01-15 15:45] setup-002: Created Vite React app, verified dev server runs
# [2025-01-15 16:00] BLOCKER: Supabase CLI not installed, need to run npm install -g supabase
#
# ============================================================================
# PROGRESS LOG START
# ============================================================================

[2026-01-11 17:36] setup-001: Initialized npm monorepo with workspace configuration. Created root package.json with npm workspaces for apps/* and packages/*. Added .gitignore. Created apps/ and packages/ directories. Changed from pnpm to npm per user request.

[2026-01-11 18:15] setup-002: Configured Vite React application with TypeScript. Created apps/web using Vite react-ts template. Added path alias (@/) to vite.config.ts and tsconfig.app.json. Configured server port 5173. Verified build and dev server work correctly.

[2026-01-11 18:45] setup-003: Set up Tailwind CSS with proper configuration. Installed tailwindcss@3.4.17, postcss@8.4.47, autoprefixer@10.4.20 as dev dependencies. Created tailwind.config.js with content paths for index.html and src/**/*.{js,ts,jsx,tsx}. Created postcss.config.js with tailwindcss and autoprefixer plugins. Added @tailwind base/components/utilities directives to index.css. Added test Tailwind classes to App.tsx to verify integration.

[2026-01-11 19:40] setup-004: Initialized Supabase client configuration. Installed @supabase/supabase-js@2.49.4 as dependency. Created apps/web/.env.example with VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY placeholders. Created src/lib/supabase.ts with typed client using createClient<Database>. Added environment variable validation that throws if Supabase credentials are missing. Placeholder Database type ready to be replaced with generated types from supabase gen types.
[2026-01-11 22:05] setup-005: Created shared package for cross-package code. Created packages/shared with src/ directory structure including placeholder dice/ subdirectory. Configured package.json with npm workspace name @duragon/shared, using direct TypeScript source exports for bundler resolution. Configured tsconfig.json with ES2020 target and strict mode. Added @duragon/shared dependency to apps/web and verified import works by adding SHARED_VERSION display to App.tsx. Package uses Vite's native TypeScript resolution for development.

[2026-01-11 23:15] dice-001: Created dice parser for simple NdS expressions. Created packages/shared/src/dice/parser.ts with ParsedDice interface (count, sides) and parseDice() function. Supports parsing "1d20", "2d6", and implicit count "d20" (defaults to 1). Includes DiceParseError class for invalid expressions. Added validation for count (1-100) and sides (1-1000). Exports parseDice, DiceParseError, and ParsedDice type from dice module. TypeScript type check and build both pass.

[2026-01-11 21:26] dice-002: Extended dice parser to support modifiers (NdS+M, NdS-M). Updated DICE_REGEX to capture optional +/- modifier group. Added modifier field to ParsedDice interface (defaults to 0). Parser now correctly handles "1d20+5" -> {count: 1, sides: 20, modifier: 5} and "2d6-2" -> {count: 2, sides: 6, modifier: -2}. Updated documentation and examples. TypeScript type check and build pass for both shared package and web app.

[2026-01-11 21:29] dice-003: Extended dice parser to support keep highest/lowest expressions (kh/kl). Added KeepMode type ('highest' | 'lowest') and optional keep/keepCount fields to ParsedDice interface. Updated DICE_REGEX to capture optional kh/kl group with keep count. Parser now correctly handles "2d20kh1" -> {count: 2, sides: 20, modifier: 0, keep: 'highest', keepCount: 1}, "2d20kl1" -> {..., keep: 'lowest', keepCount: 1}, and "4d6kh3" -> {..., keep: 'highest', keepCount: 3}. Added validation that keepCount must be at least 1 and cannot exceed dice count. Exported KeepMode type from dice module. TypeScript type check and build pass for both shared package and web app.

[2026-01-11 21:45] dice-004: Extended dice parser to support drop highest/lowest expressions (dh/dl). Added DropMode type ('highest' | 'lowest') and optional drop/dropCount fields to ParsedDice interface. Updated DICE_REGEX to capture kh/kl/dh/dl notation. Parser now correctly handles "4d6dl1" -> {count: 4, sides: 6, modifier: 0, drop: 'lowest', dropCount: 1}, "3d20dh1" -> {..., drop: 'highest', dropCount: 1}, and "4d6dl1+2" -> {..., modifier: 2, drop: 'lowest', dropCount: 1}. Added validation that dropCount must be at least 1 and cannot drop all dice (dropCount < count). Exported DropMode type from dice module. TypeScript type check and build pass for both shared package and web app.
